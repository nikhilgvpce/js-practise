<html>

<head>
    <link rel="stylesheet" href="index.css" />
</head>

<body>
    <div class="parent">
        <input name="query-input" placeholder="enter your query" />
        <div class="suggestion-box"></div>
    </div>
</body>

<script>
    let suggestions = [];
    const parent = document.getElementsByClassName('parent')[0];
    const input = document.getElementsByTagName('input')[0];
    const suggestionBox = document.getElementsByClassName('suggestion-box')[0];

    parent.onclick = handleParentClick;
    input.oninput = handleInputChange;
    input.onfocus = showSuggestions(suggestions);
    input.onclick = showSuggestions(suggestions);
    suggestionBox.onclick = handleSuggestionSelect;

    function handleSuggestionSelect(event) {
        input.value = event.target.innerText;
        if(!input.value) return;
        suggestions = callFakeAPi('showing results for ' + input.value);
        suggestionBox.replaceChildren('');
        suggestionBox.scrollTo(0, 0);
        showSuggestions(suggestions);
        input.focus();
    }

    function handleParentClick(e) {
        if (event.target.name == 'parent') {
            blurInput();
        } else if(suggestions.length) {
            suggestionBox.style.display = 'flex';
        }

    }


    function blurInput() {
        suggestionBox.style.display = 'none';
    }


    function showSuggestions(apiResults) {
        if (!apiResults.length) {
            return;
        }
        apiResults.forEach((res) => {
            const div = document.createElement('div');
            div.innerText = res;
            div.classList.add('suggestion');
            suggestionBox.style.display = 'flex';
            suggestionBox.appendChild(div);
        });
    }
    function callFakeAPi(value) {
        return value.split('').map((str, index) => value + index)
    }
    function handleInputChange(e) {
        const value = e.target.value;
        console.log(e.target.value)
        if (value) {
            suggestions = callFakeAPi(value);
            if (suggestions.length) {
                showSuggestions(suggestions)
            }
        }
    }
</script>

</html>